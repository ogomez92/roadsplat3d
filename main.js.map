{"version":3,"sources":["utilities.js","input.js","keycodes.js","tts.js","soundObject.js","scrollingText.js","strings.js","languageSelector.js","soundSource.js","soundHandler.js","timer.js","gameObject.js","tile.js","street.js","objective.js","car.js","vehicles.js","road.js","player.js","world.js","game.js","main.js"],"names":["GameUtils","calculateDelta","lx","sx","sr","delta","progressPan","current","max","progressPitch","min","minPitch","maxPitch","progressVolume","minVolume","maxVolume","getProportion","distance3D","x1","y1","z1","x2","y2","z2","Math","sqrt","distance","jx","jy","kx","ky","calculateAngle","angle","atan2","PI","isCollide3D","a","b","x","width","y","height","z","depth","randomInt","floor","random","getRandomArbitrary","sleep","ms","Promise","resolve","setTimeout","percent","int1","int2","percentOf","percentage","percented","value","average","arr","startIndex","len","length","val","i","averageInt","neg","num","numericSort","shuffle","j","objSize","obj","size","key","hasOwnProperty","copyObject","Object","assign","create","getPrototypeOf","arraysEqual","arr1","arr2","pauseTimeout","timerId","Date","now","clearTimeout","resumeTimeout","window","remaining","start","callback","randomProperty","keys","findFiles","path","ext","list","fileExt","walk","filesSync","pb","pf","stat","next","push","substr","findFolders","dirsSync","utils","EventEmitter","require","KeyboardInput","constructor","keyDown","justPressed","chars","justReleased","justPressedEventCallback","charEventCallback","init","that","document","addEventListener","event","handleKeyDown","handleKeyUp","handleChar","pause","isPaused","resume","which","emit","char","String","fromCharCode","destroy","isDown","isJustPressed","isJustReleased","keysDown","kd","forEach","v","getChars","keysPressed","splice","releaseAllKeys","keysReleased","KeyEvent","DOM_VK_CANCEL","DOM_VK_HELP","DOM_VK_BACK_SPACE","DOM_VK_TAB","DOM_VK_CLEAR","DOM_VK_RETURN","DOM_VK_ENTER","DOM_VK_SHIFT","DOM_VK_CONTROL","DOM_VK_ALT","DOM_VK_PAUSE","DOM_VK_CAPS_LOCK","DOM_VK_ESCAPE","DOM_VK_SPACE","DOM_VK_PAGE_UP","DOM_VK_PAGE_DOWN","DOM_VK_END","DOM_VK_HOME","DOM_VK_LEFT","DOM_VK_UP","DOM_VK_RIGHT","DOM_VK_DOWN","DOM_VK_PRINTSCREEN","DOM_VK_INSERT","DOM_VK_DELETE","DOM_VK_0","DOM_VK_1","DOM_VK_2","DOM_VK_3","DOM_VK_4","DOM_VK_5","DOM_VK_6","DOM_VK_7","DOM_VK_8","DOM_VK_9","DOM_VK_SEMICOLON","DOM_VK_EQUALS","DOM_VK_A","DOM_VK_B","DOM_VK_C","DOM_VK_D","DOM_VK_E","DOM_VK_F","DOM_VK_G","DOM_VK_H","DOM_VK_I","DOM_VK_J","DOM_VK_K","DOM_VK_L","DOM_VK_M","DOM_VK_N","DOM_VK_O","DOM_VK_P","DOM_VK_Q","DOM_VK_R","DOM_VK_S","DOM_VK_T","DOM_VK_U","DOM_VK_V","DOM_VK_W","DOM_VK_X","DOM_VK_Y","DOM_VK_Z","DOM_VK_CONTEXT_MENU","DOM_VK_NUMPAD0","DOM_VK_NUMPAD1","DOM_VK_NUMPAD2","DOM_VK_NUMPAD3","DOM_VK_NUMPAD4","DOM_VK_NUMPAD5","DOM_VK_NUMPAD6","DOM_VK_NUMPAD7","DOM_VK_NUMPAD8","DOM_VK_NUMPAD9","DOM_VK_MULTIPLY","DOM_VK_ADD","DOM_VK_SEPARATOR","DOM_VK_SUBTRACT","DOM_VK_DECIMAL","DOM_VK_DIVIDE","DOM_VK_F1","DOM_VK_F2","DOM_VK_F3","DOM_VK_F4","DOM_VK_F5","DOM_VK_F6","DOM_VK_F7","DOM_VK_F8","DOM_VK_F9","DOM_VK_F10","DOM_VK_F11","DOM_VK_F12","DOM_VK_F13","DOM_VK_F14","DOM_VK_F15","DOM_VK_F16","DOM_VK_F17","DOM_VK_F18","DOM_VK_F19","DOM_VK_F20","DOM_VK_F21","DOM_VK_F22","DOM_VK_F23","DOM_VK_F24","DOM_VK_NUM_LOCK","DOM_VK_SCROLL_LOCK","DOM_VK_COMMA","DOM_VK_PERIOD","DOM_VK_SLASH","DOM_VK_BACK_QUOTE","DOM_VK_OPEN_BRACKET","DOM_VK_BACK_SLASH","DOM_VK_CLOSE_BRACKET","DOM_VK_QUOTE","DOM_VK_META","app","remote","useWebTTS","TTS","webTTS","voices","speechController","ducking","lang","synth","Speech","rate","interrupt","speak","VK_CONTROL","splitSentences","then","data","catch","e","setLanguage","err","setRate","r","newRate","text","queue","accessibilitySupportEnabled","listeners","onstart","duck","onend","unduck","onerror","getElementById","innerHTML","para","createElement","appendChild","createTextNode","setWebTTS","tts","stop","cancel","changeRate","speech","inp","changeVoice","name","voiceArray","k","includes","setVoice","cb","silent","wl","split","strings","get","input","selection","ducker","playOnceTimer","panner","defaults","panningModel","maxDistance","sono","playInBackground","SoundObjectItem","file","tag","stream","duckingFirstTime","fileName","sound","src","onComplete","doneLoading","timeout","checkProgress","loaded","Audio","playbackRate","pitch","loop","progress","replay","play","unload","time","oldVolume","volume","fade","pos","forcePlay","playSync","die","evt","once","removeAllListeners","active","playing","pan","currentPan","effects","add","set","seek","currentTime","duration","position","SoundObject","sounds","Array","loadingQueue","queueCallback","loadedSounds","loadingSounds","loadedCallback","queueLength","statusCallback","directory","extension","oneShots","debug","oneShotSound","setStatusCallback","findSound","findSoundIndex","resetQueuedInstance","found","returnObject","loadQueueSync","so","setQueueCallback","loadQueue","createSync","snd","enqueue","handleQueue","resetQueue","setCallback","isLoading","playOnce","on","noMore","filename","kill","destroyAll","undefined","runningText","ScrollingText","delimiter","splitText","currentLine","sndOpen","sndContinue","sndClose","prom","res","handleKeys","readCurrentLine","copyCurrentLine","advance","handleTap","action","str","removeEventListener","Strings","selectVoice","mSelectVoice","mLang","newUpdate","mSapi","mReader","upArrowMove","rating","mRate","K","Q","A","J","cspades","cdiamonds","cclubs","chearts","dq","langs","mainmenu","mSelect","mBack","mStart","yes","no","ok","what","rep","i1","Number","replace","check","lng","LanguageSelector","element","id","container","buttons","type","focus","module","exports","SoundSource","son","speed","minRate","maxRate","toDestroy","rateShiftSpeed","currentPosition","setPosition","update","SoundHandler","directional","staticSounds","dynamicSounds","currentDynamicSound","maxDynamicSounds","currentStaticSound","maxStaticSounds","reuseSounds","playStatic","slot","findFreeStaticSlot","SoundItem","findFreeDynamicSlot","findDynamicSound","reuse","threeD","GameObject","world","alive","mediaSource","context","createMediaElementSource","source","scene","createSource","sourceWidth","sourceHeight","sourceDepth","connect","Tile","hasSomething","player","step","game","pool","tileType","Street","Objective","levelCap","level","scoreDeduct","tick","score","generateTiles","slowDown","Car","tile","side","canHorn","passed","hornSound","hornSource","hornResonanceSource","jump","round","generateCar","content","numberOfVehicles","spawnTime","scoreSound","healthLoss","hp","hit","flyTo","nearestStreet","BusFaster","Bus","Biker","Road","force","carType","dynamicObjects","Player","playerHitSound","fallTime","setListenerPosition","unableToMove","speedUpSound","nearestRoad","nearestObjective","speedDownSound","speeds","speedModifier","currentSpeed","move","speedTimeout","xLimit","ceil","speedUp","number","heart","land","fall","stand","interval","setInterval","clearInterval","ResonanceAudio","World","tiles","AudioContext","convolution","createConvolver","output","destination","lastStreet","lastStreetLimit","roadsPerLevel","lastRoad","Game","timer","render","coins","dt","debugRoad","_","gameID","version","version2","ttsVoice","ttsRate","setup","reject","fetch","result","console","log"],"mappings":"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","file":"main.js","sourceRoot":"js","sourcesContent":["import \"babel-polyfill\";\r\n'use strict';\r\nclass GameUtils {\r\n\tcalculateDelta(lx, sx, sr = 0) {\r\n\t\tsx = sx + sr;\r\n\t\tif (sx < lx) {\r\n\t\t\tdelta = lx - sx;\r\n\t\t}\r\n\t\tif (sx > lx) {\r\n\t\t\tdelta = sx - lx;\r\n\t\t}\r\n\r\n\t}\r\n\tprogressPan(current, max) {\r\n\t\treturn ((current * 200 / max) - 100) / 100;\r\n\t}\r\n\r\n\tprogressPitch(current, min, max, minPitch, maxPitch) {\r\n\t\treturn (current / (min + max)) * (maxPitch - minPitch) + minPitch;\r\n\t}\r\n\r\n\tprogressVolume(current, min, max, minVolume, maxVolume) {\r\n\t\tif (current > max) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn (current / (min + max)) * (maxVolume - minVolume) + minVolume;\r\n\t}\r\n\r\n\tgetProportion(current, min, max, minVolume, maxVolume) {\r\n\t\tif (current > max) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn (current / (min + max)) * (maxVolume - minVolume) + minVolume;\r\n\t}\r\n\r\n\tdistance3D(x1, y1, z1, x2, y2, z2) {\r\n\t\treturn Math.sqrt((x2 - x1) * (x2 - x1) +\r\n\t\t\t(y2 - y1) * (y2 - y1) +\r\n\t\t\t(z2 - z1) * (z2 - z1));\r\n\t}\r\n\r\n\tdistance(jx, jy, kx, ky) {\r\n\t\t// Return Math.hypot(jx-kx, jy-ky)\r\n\t\treturn Math.sqrt(((jx - kx) * (jx - kx)) + ((jy - ky)) * (jy - ky));\r\n\t}\r\n\r\n\tcalculateAngle(x1, y1, x2, y2) {\r\n\t\tlet angle = Math.atan2((y2 - y1), (x2 - x1));\r\n\t\tangle = (angle >= 0) ? 0 : (2 * Math.PI) + angle;\r\n\t\treturn angle;\r\n\t\t// Return Math.atan2((y2 - y1),(x2 - x1));\r\n\t}\r\n\r\n\tisCollide3D(a, b) {\r\n\t\treturn (a.x <= (b.x + b.width) && (a.x + a.width) >= b.x) && (a.y <= (b.y + b.height) && (a.y + a.height) >= b.y) && (a.z <= (b.z + b.depth) && (a.z + a.depth) >= b.z);\r\n\t}\r\n\r\n\trandomInt(min, max) {\r\n\t\treturn Math.floor(Math.random() * (max - min + 1)) + min;\r\n\t}\r\n\r\n\tgetRandomArbitrary(min, max) {\r\n\t\treturn Math.random() * (max - min) + min;\r\n\t}\r\n\r\n\tsleep(ms) {\r\n\t\treturn new Promise(resolve => setTimeout(resolve, ms));\r\n\t}\r\n\r\n\tpercent(int1, int2) {\r\n\t\treturn int1 * 100 / int2;\r\n\t}\r\n\r\n\tpercentOf(int1, int2) {\r\n\t\treturn int2 * int1 / 100;\r\n\t}\r\n\tpercentage(percented, value) {\r\n\t\treturn value * percented / 100;\r\n\t}\r\n\r\n\taverage(arr, startIndex = 0) {\r\n\t\tconst len = arr.length;\r\n\t\tlet val = 0;\r\n\t\tlet average = 0;\r\n\t\tif (arr.length < startIndex) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tfor (let i = startIndex; i < arr.length; i++) {\r\n\t\t\tval += arr[i];\r\n\t\t}\r\n\r\n\t\taverage = val / (len - startIndex);\r\n\t\treturn average;\r\n\t}\r\n\r\n\taverageInt(arr, startIndex = 0) {\r\n\t\tconst len = arr.length;\r\n\t\tlet val = 0;\r\n\t\tlet average = 0;\r\n\t\tif (arr.length < startIndex) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tfor (let i = startIndex; i < arr.length; i++) {\r\n\t\t\tval += arr[i];\r\n\t\t}\r\n\r\n\t\taverage = val / (len - startIndex);\r\n\t\treturn Math.floor(average);\r\n\t}\r\n\r\n\tneg(num) {\r\n\t\treturn (num >= 0 ? (num == 0 ? 0 : 1) : -1);\r\n\t}\r\n\r\n\tnumericSort(a, b) {\r\n\t\treturn (a < b ? -1 : (a == b ? 0 : 1));\r\n\t}\r\n\r\n\tshuffle(a) {\r\n\t\tfor (let i = a.length - 1; i > 0; i--) {\r\n\t\t\tconst j = Math.floor(Math.random() * (i + 1));\r\n\t\t\t[a[i], a[j]] = [a[j], a[i]];\r\n\t\t}\r\n\r\n\t\treturn a;\r\n\t}\r\n\r\n\tobjSize(obj) {\r\n\t\tlet size = 0;\r\n\r\n\t\tlet key;\r\n\t\tfor (key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tsize++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn size;\r\n\t}\r\n\tcopyObject(obj) {\r\n\t\treturn Object.assign(Object.create(Object.getPrototypeOf(obj)), obj);\r\n\t}\r\n\tarraysEqual(arr1, arr2) {\r\n\t\tfor (var i = 0; i < arr1.length; i++) {\r\n\r\n\t\t\tif (arr1[i] !== arr2[i])\r\n\t\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpauseTimeout(timerId) {\r\n\t\tlet start = Date.now();\r\n\t\tclearTimeout(timerId);\r\n\t};\r\n\r\n\tresumeTimeout(timerId) {\r\n\t\tremaining -= Date.now() - start;\r\n\t\treturn window.setTimeout(callback, remaining);\r\n\t};\r\n\trandomProperty(obj) {\r\n\t\tvar keys = Object.keys(obj)\r\n\t\treturn obj[keys[keys.length * Math.random() << 0]];\r\n\t};\r\n\t\tasync findFiles(path,ext=\"\") {\r\nlet list=[];\r\nlet fileExt=\"\";\r\nawait walk.filesSync(path, (pb, pf, stat, next) => {\r\nif (ext==\"\") {\r\nlist.push(pf);\r\n}\r\nelse {\r\nfileExt=pf.substr(0-ext.length,ext.length);\r\nif (fileExt==ext) {\r\nlist.push(pf);\r\n}\r\n}\r\n});\r\nreturn list;\r\n}\r\nasync findFolders(path) {\r\nlet list=[];\r\nawait walk.dirsSync(path, (pb, pf, stat, next) => {\r\nlist.push(pf);\r\n});\r\nreturn list;\r\n}\r\n}\r\nexport var utils = new GameUtils();\r\n","import $ from 'jquery';\r\nconst EventEmitter = require('events');\r\n'use strict';\r\nclass KeyboardInput extends EventEmitter {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.keyDown = [];\r\n\t\tthis.justPressed = [];\r\n\t\tthis.chars = [];\r\n\t\tthis.justReleased = [];\r\n\t\tthis.justPressedEventCallback = null;\r\n\t\tthis.charEventCallback = null;\r\n\t}\r\n\r\n\tinit() {\r\n\t\tconst that = this;\r\n\t\t// \t\t$(document).keydown(function(event) { that.handleKeyDown(event); });\r\n\t\t// \t\t$(document).keyup(function(event) { that.handleKeyUp(event); });\r\n\t\tdocument.addEventListener('keydown', event => {\r\n\t\t\tthat.handleKeyDown(event);\r\n\t\t});\r\n\t\tdocument.addEventListener('keyup', event => {\r\n\t\t\tthat.handleKeyUp(event);\r\n\t\t});\r\n\t\tdocument.addEventListener('keypress', event => {\r\n\t\t\tthat.handleChar(event);\r\n\t\t});\r\n\t}\r\n\tpause() {\r\n\t\tthis.isPaused = true;\r\n\t}\r\n\tresume() {\r\n\t\tthis.isPaused = false;\r\n\t}\r\n\thandleKeyDown(event) {\r\n\t\tif (this.keyDown[event.which] != true || typeof this.keyDown[event.which] === 'undefined') {\r\n\t\t\tthis.keyDown[event.which] = true;\r\n\t\t\tthis.justPressed[event.which] = true;\r\n\t\t\tthis.emit(event.which);\r\n\t\t\tthis.justReleased[event.which] = false;\r\n\t\t\tif (typeof this.justPressedEventCallback !== 'undefined' && this.justPressedEventCallback != null) {\r\n\t\t\t\tthis.justPressedEventCallback(event.which);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thandleChar(char) {\r\n\t\tif (char.which < 48 || char.which > 122) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (String.fromCharCode(char.which) != '') {\r\n\t\t\tthis.chars += String.fromCharCode(char.which);\r\n\t\t\tthis.emit(\"chr\" + String.fromCharCode(char.which));\r\n\t\t\tif (typeof this.charEventCallback !== 'undefined' && this.charEventCallback != null) {\r\n\t\t\t\tthis.charEventCallback(String.fromCharCode(char.which));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thandleKeyUp(event) {\r\n\t\tif (this.keyDown[event.which] == true) {\r\n\t\t\tthis.keyDown[event.which] = false;\r\n\t\t\tthis.justPressed[event.which] = false;\r\n\t\t\tthis.justReleased[event.which] = true;\r\n\t\t\tthis.emit(\"!\" + event.which);\r\n\t\t}\r\n\t\tthis.chars = '';\r\n\t}\r\n\tdestroy() {\r\n\t\tthis.charEventCallback = null;\r\n\t\tthis.justPressedEventCallback = null;\r\n\t}\r\n\tisDown(event) {\r\n\t\tif (this.isPaused) return false;\r\n\t\treturn this.keyDown[event];\r\n\t}\r\n\r\n\tisJustPressed(event) {\r\n\t\tif (this.isPaused) return false;\r\n\t\tif (this.justPressed[event] == true) {\r\n\t\t\tthis.justPressed[event] = false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tisJustReleased(event) {\r\n\t\tif (this.justReleased[event]) {\r\n\t\t\tthis.justReleased[event] = false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tkeysDown() {\r\n\t\tconst kd = [];\r\n\t\tthis.keyDown.forEach((v, i) => {\r\n\t\t\tif (v) {\r\n\t\t\t\tkd.push(i);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn kd;\r\n\t}\r\n\r\n\tgetChars() {\r\n\t\tconst kd = this.chars;\r\n\t\tthis.chars = '';\r\n\t\treturn kd;\r\n\t}\r\n\r\n\tkeysPressed() {\r\n\t\tconst kd = [];\r\n\t\tthis.justPressed.forEach((v, i) => {\r\n\t\t\tif (v) {\r\n\t\t\t\tkd.push(i);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.justPressed.splice();\r\n\t\treturn kd;\r\n\t}\r\n\r\n\treleaseAllKeys() {\r\n\r\n\t}\r\n\r\n\tkeysReleased() {\r\n\t\tconst kd = [];\r\n\t\tthis.justReleased.forEach((v, i) => {\r\n\t\t\tif (v) {\r\n\t\t\t\tkd.push(i);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.justReleased.splice();\r\n\t\treturn kd;\r\n\t}\r\n}\r\n\r\nexport { KeyboardInput };\r\n","\r\n'use strict';\r\nconst KeyEvent = {\r\nDOM_VK_CANCEL: 3,\r\n\t       DOM_VK_HELP: 6,\r\n\t       DOM_VK_BACK_SPACE: 8,\r\n\t       DOM_VK_TAB: 9,\r\n\t       DOM_VK_CLEAR: 12,\r\n\t       DOM_VK_RETURN: 13,\r\n\t       DOM_VK_ENTER: 14,\r\n\t       DOM_VK_SHIFT: 16,\r\n\t       DOM_VK_CONTROL: 17,\r\n\t       DOM_VK_ALT: 18,\r\n\t       DOM_VK_PAUSE: 19,\r\n\t       DOM_VK_CAPS_LOCK: 20,\r\n\t       DOM_VK_ESCAPE: 27,\r\n\t       DOM_VK_SPACE: 32,\r\n\t       DOM_VK_PAGE_UP: 33,\r\n\t       DOM_VK_PAGE_DOWN: 34,\r\n\t       DOM_VK_END: 35,\r\n\t       DOM_VK_HOME: 36,\r\n\t       DOM_VK_LEFT: 37,\r\n\t       DOM_VK_UP: 38,\r\n\t       DOM_VK_RIGHT: 39,\r\n\t       DOM_VK_DOWN: 40,\r\n\t       DOM_VK_PRINTSCREEN: 44,\r\n\t       DOM_VK_INSERT: 45,\r\n\t       DOM_VK_DELETE: 46,\r\n\t       DOM_VK_0: 48,\r\n\t       DOM_VK_1: 49,\r\n\t       DOM_VK_2: 50,\r\n\t       DOM_VK_3: 51,\r\n\t       DOM_VK_4: 52,\r\n\t       DOM_VK_5: 53,\r\n\t       DOM_VK_6: 54,\r\n\t       DOM_VK_7: 55,\r\n\t       DOM_VK_8: 56,\r\n\t       DOM_VK_9: 57,\r\n\t       DOM_VK_SEMICOLON: 59,\r\n\t       DOM_VK_EQUALS: 61,\r\n\t       DOM_VK_A: 65,\r\n\t       DOM_VK_B: 66,\r\n\t       DOM_VK_C: 67,\r\n\t       DOM_VK_D: 68,\r\n\t       DOM_VK_E: 69,\r\n\t       DOM_VK_F: 70,\r\n\t       DOM_VK_G: 71,\r\n\t       DOM_VK_H: 72,\r\n\t       DOM_VK_I: 73,\r\n\t       DOM_VK_J: 74,\r\n\t       DOM_VK_K: 75,\r\n\t       DOM_VK_L: 76,\r\n\t       DOM_VK_M: 77,\r\n\t       DOM_VK_N: 78,\r\n\t       DOM_VK_O: 79,\r\n\t       DOM_VK_P: 80,\r\n\t       DOM_VK_Q: 81,\r\n\t       DOM_VK_R: 82,\r\n\t       DOM_VK_S: 83,\r\n\t       DOM_VK_T: 84,\r\n\t       DOM_VK_U: 85,\r\n\t       DOM_VK_V: 86,\r\n\t       DOM_VK_W: 87,\r\n\t       DOM_VK_X: 88,\r\n\t       DOM_VK_Y: 89,\r\n\t       DOM_VK_Z: 90,\r\n\t       DOM_VK_CONTEXT_MENU: 93,\r\n\t       DOM_VK_NUMPAD0: 96,\r\n\t       DOM_VK_NUMPAD1: 97,\r\n\t       DOM_VK_NUMPAD2: 98,\r\n\t       DOM_VK_NUMPAD3: 99,\r\n\t       DOM_VK_NUMPAD4: 100,\r\n\t       DOM_VK_NUMPAD5: 101,\r\n\t       DOM_VK_NUMPAD6: 102,\r\n\t       DOM_VK_NUMPAD7: 103,\r\n\t       DOM_VK_NUMPAD8: 104,\r\n\t       DOM_VK_NUMPAD9: 105,\r\n\t       DOM_VK_MULTIPLY: 106,\r\n\t       DOM_VK_ADD: 107,\r\n\t       DOM_VK_SEPARATOR: 108,\r\n\t       DOM_VK_SUBTRACT: 109,\r\n\t       DOM_VK_DECIMAL: 110,\r\n\t       DOM_VK_DIVIDE: 111,\r\n\t       DOM_VK_F1: 112,\r\n\t       DOM_VK_F2: 113,\r\n\t       DOM_VK_F3: 114,\r\n\t       DOM_VK_F4: 115,\r\n\t       DOM_VK_F5: 116,\r\n\t       DOM_VK_F6: 117,\r\n\t       DOM_VK_F7: 118,\r\n\t       DOM_VK_F8: 119,\r\n\t       DOM_VK_F9: 120,\r\n\t       DOM_VK_F10: 121,\r\n\t       DOM_VK_F11: 122,\r\n\t       DOM_VK_F12: 123,\r\n\t       DOM_VK_F13: 124,\r\n\t       DOM_VK_F14: 125,\r\n\t       DOM_VK_F15: 126,\r\n\t       DOM_VK_F16: 127,\r\n\t       DOM_VK_F17: 128,\r\n\t       DOM_VK_F18: 129,\r\n\t       DOM_VK_F19: 130,\r\n\t       DOM_VK_F20: 131,\r\n\t       DOM_VK_F21: 132,\r\n\t       DOM_VK_F22: 133,\r\n\t       DOM_VK_F23: 134,\r\n\t       DOM_VK_F24: 135,\r\n\t       DOM_VK_NUM_LOCK: 144,\r\n\t       DOM_VK_SCROLL_LOCK: 145,\r\n\t       DOM_VK_COMMA: 188,\r\n\t       DOM_VK_PERIOD: 190,\r\n\t       DOM_VK_SLASH: 191,\r\n\t       DOM_VK_BACK_QUOTE: 192,\r\n\t       DOM_VK_OPEN_BRACKET: 219,\r\n\t       DOM_VK_BACK_SLASH: 220,\r\n\t       DOM_VK_CLOSE_BRACKET: 221,\r\n\t       DOM_VK_QUOTE: 222,\r\n\t       DOM_VK_META: 224\r\n};\r\nexport {KeyEvent};\r\n","import \"babel-polyfill\";\r\nconst { app } = require('electron').remote;\r\nimport { report } from './main';\r\n\r\n'use strict';\r\n\r\nimport { strings } from './strings';\r\nimport { utils } from './utilities'\r\nimport { lang, ttsVoice, ttsRate } from './main';\r\nimport { KeyboardInput } from './input.js';\r\nimport { KeyEvent } from './keycodes';\r\nconst useWebTTS = true;\r\nimport Speech from 'speak-tts' // es6\r\nclass TTS {\r\n\tconstructor(webTTS = true) {\r\n\t\tthis.voices = []\r\n\t\tthis.speechController = new KeyboardInput();\r\n\t\tthis.speechController.init();\r\n\t\tthis.ducking = false;\r\n\t\tif (lang == 1) this.lang = \"en\";\r\n\t\tif (lang == 2) this.lang = \"es\";\r\n\t\tthis.webTTS = webTTS;\r\n\t\tthis.synth = new Speech()\r\n\t\tthis.rate = 2;\r\n\t\tthis.speechController.justPressedEventCallback = (key) => {\r\n\t\t\tif (this.interrupt) this.speak(\"\", false);\r\n\t\t\tif (key == KeyEvent.VK_CONTROL || key == KeyEvent.DOM_VK_ESCAPE) {\r\n\t\t\t\tthis.speak(\"\", false);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.synth.init({\r\n\t\t\tlang: this.lang,\r\n\t\t\trate: this.rate,\r\n\t\t\tsplitSentences: false,\r\n\t\t})\r\n\t\t\t.then((data) => {\r\n\t\t\t\tthis.voices = data.voices;\r\n\t\t\t}).catch(e => {\r\n\t\t\t\treport(e);\r\n\t\t\t})\r\n\t}\r\n\tsetLanguage(lang) {\r\n\t\ttry {\r\n\t\t\tif (lang == 1) this.lang = \"en\";\r\n\t\t\tif (lang == 2) this.lang = \"es\";\r\n\t\t\tthis.synth.setLanguage(this.lang)\r\n\t\t} catch (err) {\r\n\t\t\treport(err);\r\n\t\t}\r\n\t}\r\n\tsetRate(r) {\r\n\t\tlet newRate = r;\r\n\t\tif (r < 1) newRate == 1;\r\n\t\tif (r > 10) newRate = 10;\r\n\t\tthis.rate = newRate;\r\n\t\tthis.synth.setRate(newRate);\r\n\t}\r\n\tspeak(text, queue = false) {\r\n\t\tlet sr = app.accessibilitySupportEnabled;\r\n\r\n\t\tif (sr) this.webTTS = false;\r\n\t\tif (!sr) this.webTTS = true;\r\n\t\tif (this.webTTS) {\r\n\t\t\ttry {\r\n\t\t\t\tif (typeof text == \"number\") {\r\n\t\t\t\t\ttext = text + \".\";\r\n\t\t\t\t\t//we need this because some voices fail to process numbers. Why? Don't ask me.\r\n\t\t\t\t}\r\n\t\t\t\tthis.synth.speak({\r\n\t\t\t\t\ttext: text,\r\n\t\t\t\t\tqueue: queue,\r\n\t\t\t\t\tlisteners: {\r\n\t\t\t\t\t\tonstart: () => {\r\n\t\t\t\t\t\t\tthis.duck();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonend: () => {\r\n\t\t\t\t\t\t\tthis.unduck();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonerror: (err) => {\r\n\t\t\t\t\t\t\t//this.setVoice(null,true);\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} catch {\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.duck();\r\n\t\t\tdocument.getElementById('speech').innerHTML = '';\r\n\t\t\tconst para = document.createElement('p');\r\n\t\t\tpara.appendChild(document.createTextNode(text));\r\n\t\t\tdocument.getElementById('speech').appendChild(para);\r\n\t\t}\r\n\t} // End speak()\r\n\r\n\tsetWebTTS(tts) {\r\n\t\tthis.webTTS = tts;\r\n\t}\r\n\r\n\tstop() {\r\n\t\tif (this.webTTS) {\r\n\t\t\tthis.synth.cancel();\r\n\t\t}\r\n\t}\r\n\tasync changeRate() {\r\n\t\tlet rate = speech.rate;\r\n\t\tconst inp = new KeyboardInput();\r\n\t\tinp.init();\r\n\t\tstrings.speak('rating');\r\n\t\twhile (!inp.isJustPressed(KeyEvent.DOM_VK_RETURN)) {\r\n\t\t\tawait utils.sleep(5);\r\n\t\t\tif (inp.isJustPressed(KeyEvent.DOM_VK_RIGHT)) {\r\n\t\t\t\trate += 0.25;\r\n\t\t\t\tif (rate > 10) rate = 10;\r\n\r\n\t\t\t\tspeech.setRate(rate)\r\n\t\t\t\tstrings.speak('newRate');\r\n\t\t\t}\r\n\t\t\tif (inp.isJustPressed(KeyEvent.DOM_VK_LEFT)) {\r\n\t\t\t\trate -= 0.25;\r\n\t\t\t\tif (rate < 1) rate = 1;\r\n\t\t\t\tspeech.setRate(rate)\r\n\t\t\t\tstrings.speak('newRate');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tchangeVoice(name) {\r\n\t\tlet voiceArray = []\r\n\t\tfor (var k in this.voices) {\r\n\t\t\tvoiceArray.push(this.voices[k].name)\r\n\t\t}\r\n\t\tif (voiceArray.includes(name)) {\r\n\t\t\tspeech.synth.setVoice(name);\r\n\t\t}\r\n\r\n\t}\r\n\tsetVoice(cb, silent = false) {\r\n\t\t//what language do we want?\r\n\t\tlet wl = \"en\";\r\n\t\tif (lang == 1) wl = \"en\";\r\n\t\tif (lang == 2) wl = \"es\";\r\n\t\tlet voiceArray = []\r\n\t\tfor (var k in this.voices) {\r\n\t\t\t//get the first part of the voice languages\r\n\t\t\tlet vl = this.voices[k].lang.split(\"-\")[0]\r\n\t\t\t//do we want this language?\r\n\t\t\tif (vl == wl) {\r\n\t\t\t\tvoiceArray.push(this.voices[k].name)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!silent) speech.speak(strings.get(\"selectVoice\", [voiceArray.length]));\r\n\t\tlet input = new KeyboardInput()\r\n\t\tlet selection = -1;\r\n\t\tinput.init();\r\n\t\tif (!silent) {\r\n\t\t\tinput.justPressedEventCallback = ((key) => {\r\n\t\t\t\tif (key == KeyEvent.DOM_VK_DOWN) {\r\n\t\t\t\t\tselection++;\r\n\t\t\t\t\tif (selection >= voiceArray.length) selection = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (key == KeyEvent.DOM_VK_UP) {\r\n\t\t\t\t\tselection--;\r\n\t\t\t\t\tif (selection <= -1) selection = voiceArray.length - 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (key != KeyEvent.DOM_VK_RETURN && (key == KeyEvent.DOM_VK_UP || key == KeyEvent.DOM_VK_DOWN)) { //dirty hack\r\n\t\t\t\t\tthis.synth.setVoice(voiceArray[selection]);\r\n\t\t\t\t\tspeech.speak(voiceArray[selection])\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t//it is enter\r\n\t\t\t\t\tif (selection != -1) { //don't crash if it's -1.\r\n\t\t\t\t\t\tinput.destroy();\r\n\t\t\t\t\t\tif (typeof cb !== \"undefined\") {\r\n\t\t\t\t\t\t\tcb(voiceArray[selection])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn voiceArray[selection]\r\n\t\t\t\t\t}\r\n\t\t\t\t}//enter action\r\n\t\t\t});//callback\r\n\t\t} //not silent\r\n\t\telse {\r\n\t\t\ttry {\r\n\t\t\t\tthis.synth.setVoice(voiceArray[0]);\r\n\t\t\t\treturn voiceArray[0];\r\n\t\t\t} catch (err) {\r\n\t\t\t\treport(err);\r\n\t\t\t\tthis.synth.setVoice(voiceArray[1]);\r\n\t\t\t\treturn voiceArray[1];\r\n\t\t\t} // catch block\r\n\t\t}//else\r\n\t}//function\r\n\tduck() {\r\n\t\tif (this.ducking) return;\r\n\t\tthis.ducking = true;\r\n\t\tif (typeof this.ducker !== \"undefined\") this.ducker.duck();\r\n\t}\r\n\tunduck() {\r\n\t\tthis.ducking = false;\r\n\t\tif (typeof this.ducker !== \"undefined\") this.ducker.unduck();\r\n\t}\r\n\r\n} // End class\r\nconst speech = new TTS(false);\r\n//if (process.platform == 'darwin') {\r\n//\tspeech.webTTS = true;\r\n//}\r\nexport { TTS, speech };\r\n","import \"babel-polyfill\";\r\nimport { report } from './main';\r\nimport { speech } from './tts';\r\nimport panner from 'sono/effects/panner';\r\nconst EventEmitter = require('events');\r\nimport sono from 'sono';\r\nimport { KeyboardInput } from './input';\r\nimport { KeyEvent } from './keycodes';\r\nimport { utils } from './utilities';\r\npanner.defaults = {\r\n\tpanningModel: 'HRTF',\r\n\tmaxDistance: 50,\r\n};\r\nsono.playInBackground = true;\r\nvar playOnceTimer;\r\nclass SoundObjectItem extends EventEmitter {\r\n\tconstructor(file, callback = 0, tag = 0, stream = false) {\r\n\t\tsuper();\r\n\t\tthis.duckingFirstTime = true;\r\n\t\tthis.stream = stream;\r\n\t\tthis.panner = null;\r\n\t\tthis.fileName = file;\r\n\t\tif (typeof file == \"string\") {\r\n\t\t\tif (!stream) {\r\n\t\t\t\tthis.sound = sono.create({\r\n\t\t\t\t\tsrc: file,\r\n\t\t\t\t\tonComplete: () => { this.doneLoading(); }\r\n\t\t\t\t});\r\n\t\t\t\tthis.timeout = setTimeout(() => { this.checkProgress(); }, 2000);\r\n\t\t\t\tthis.loaded = false;\r\n\t\t\t\tthis.callback = callback;\r\n\t\t\t\tthis.tag = tag;\r\n\t\t\t}\r\n\t\t\tif (stream) {\r\n\t\t\t\tthis.loaded = true;\r\n\t\t\t\tthis.callback = callback;\r\n\t\t\t\tthis.tag = tag;\r\n\t\t\t\tthis.sound = sono.create(new Audio(file));\r\n\t\t\t\tthis.doneLoading();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (typeof file == \"object\") {\r\n\t\t\tthis.sound = sono.create(\"\");\r\n\t\t\tthis.sound.data = file;\r\n\t\t\tthis.loaded = false;\r\n\t\t\tthis.callback = callback;\r\n\t\t\tthis.tag = tag;\r\n\t\t\tthis.doneLoading();\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tget playbackRate() {\r\n\t\treturn this.sound.playbackRate\r\n\t}\r\n\r\n\tset playbackRate(v) {\r\n\t\treturn this.sound.playbackRate = v;\r\n\t}\r\n\tget pitch() {\r\n\t\treturn this.sound.playbackRate\r\n\t}\r\n\r\n\tset pitch(v) {\r\n\t\treturn this.sound.playbackRate = v;\r\n\t}\r\n\r\n\tset loop(v) {\r\n\t\tthis.sound.loop = v;\r\n\t}\r\n\r\n\tcheckProgress() {\r\n\t\tif (this.stream) return;\r\n\t\tif (this.sound.progress == 0) {\r\n\t\t\tthis.sound.destroy();\r\n\t\t\tthis.sound = sono.create({ src: this.fileName, onComplete: () => { this.doneLoading(); } }, this.stream);\r\n\t\t}\r\n\r\n\t\tif (this.sound.progress == 1) {\r\n\t\t\tthis.doneLoading();\r\n\t\t} else {\r\n\t\t\tthis.timeout = setTimeout(() => { this.checkProgress(); }, 500);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tdoneLoading() {\r\n\t\tif (!this.stream) clearTimeout(this.timeout);\r\n\t\tthis.loaded = true;\r\n\t\tif (this.callback != 0) {\r\n\t\t\tthis.callback();\r\n\t\t}\r\n\t}\r\n\treplay() {\r\n\t\tthis.sound.stop()\r\n\t\tthis.sound.play()\r\n\t}\r\n\tplay() {\r\n\t\t//sometimes, html element sounds complain about having a different connection, so wrap it in a try catch block.\r\n\t\ttry {\r\n\t\t\tthis.sound.play();\r\n\t\t} catch (err) {\r\n\t\t\t//report(err);\r\n\t\t\t//recreate the sound and replay\r\n\t\t\tif (this.stream) this.sound = sono.create(new Audio(this.fileName));\r\n\t\t\tif (!this.stream) this.sound = sono.create({\r\n\t\t\t\tsrc: this.fileName,\r\n\t\t\t\tonComplete: () => { this.doneLoading(); }\r\n\t\t\t});\r\n\t\t\tthis.sound.play();\r\n\t\t}\r\n\t}\r\n\tstop() {\r\n\t\tthis.sound.stop();\r\n\r\n\t}\r\n\tpause() {\r\n\t\tthis.sound.pause();\r\n\t}\r\n\tresume() {\r\n\t\tthis.sound.resume();\r\n\t}\r\n\tdestroy() {\r\n\t\ttry {\r\n\r\n\t\t\tthis.sound.destroy();\r\n\t\t} catch (err) {\r\n\r\n\t\t}\r\n\t}\r\n\tunload() { this.sound.destroy(); }\r\n\tduck(time) {\r\n\t\tif (this.duckingFirstTime) this.oldVolume = this.volume;\r\n\t\tthis.duckingFirstTime = false;\r\n\t\tthis.sound.fade(0.3, 0.15);\r\n\t}\r\n\tunduck(time) {\r\n\t\tthis.sound.fade(this.oldVolume, 0.15);\r\n\t}\r\n\tasync fade(time) {\r\n\t\tthis.sound.fade(0, time / 1000);\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.sound.stop();\r\n\t\t\t\tresolve('ok');\r\n\t\t\t}, time);// End\r\n\t\t});// Promise\r\n\r\n\t}\r\n\r\n\tpos(x, y, z) {\r\n\r\n\t}\r\n\r\n\tforcePlay() {\r\n\t\tthis.sound.stop();\r\n\t\tthis.sound.play();\r\n\t}\r\n\tasync playSync(die = false) {\r\n\t\tconst inp = new KeyboardInput();\r\n\t\tinp.init();\r\n\t\tthis.sound.play();\r\n\r\n\t\tinp.justPressedEventCallback = (evt => {\r\n\t\t\tif (evt == KeyEvent.DOM_VK_Q || evt == KeyEvent.DOM_VK_X || evt == KeyEvent.DOM_VK_ESCAPE || evt == KeyEvent.DOM_VK_SPACE || evt == KeyEvent.DOM_VK_ENTER) {\r\n\t\t\t\tthis.sound.stop();\r\n\t\t\t\tinp.justPressedEventCallback = null;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tthis.sound.once('ended', () => {\r\n\t\t\t\tthis.sound.removeAllListeners();\r\n\t\t\t\tif (die) this.sound.destroy();\r\n\t\t\t\tresolve('ok');\r\n\t\t\t\tinp.justPressedEventCallback = null;\r\n\t\t\t});// End\r\n\t\t\tthis.sound.once('stop', () => {\r\n\t\t\t\tthis.sound.removeAllListeners();\r\n\t\t\t\tif (die) this.sound.destroy();\r\n\t\t\t\tresolve('ok');\r\n\t\t\t\tinp.justPressedEventCallback = null;\r\n\t\t\t});// Stop\r\n\t\t});// Promise\r\n\t}\r\n\r\n\tget active() {\r\n\t\tif (!this.sound.loaded) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (this.sound.progress < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this.sound.loaded) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t}\r\n\tget playing() {\r\n\t\treturn this.sound.playing;\r\n\t}\r\n\r\n\tget pan() {\r\n\t\tif (!this.panner) {\r\n\t\t\tthis.panner = this.sound.effects.add(panner());\r\n\t\t\tthis.currentPan = 0;\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn this.currentPan;\r\n\t}\r\n\r\n\tset pan(v) {\r\n\t\tif (!this.panner) {\r\n\t\t\tthis.panner = this.sound.effects.add(panner());\r\n\t\t}\r\n\t\tthis.currentPan = v;\r\n\t\treturn this.panner.set(v);\r\n\t}\r\n\tget volume() {\r\n\t\treturn this.sound.volume;\r\n\t}\r\n\tset volume(v) {\r\n\t\tthis.sound.volume = v;\r\n\t}\r\n\r\n\tseek(time) {\r\n\t\treturn this.sound.seek(time);\r\n\t}\r\n\r\n\tget currentTime() {\r\n\t\treturn this.sound.currentTime;\r\n\t}\r\n\r\n\tget duration() {\r\n\t\treturn this.sound.duration * 1000;\r\n\t}\r\n\r\n\tget position() {\r\n\t\treturn this.sound.currentTime;\r\n\t}\r\n\r\n\tset currentTime(v) {\r\n\t\treturn this.sound.seek(v);\r\n\t}\r\n\r\n}\r\n\r\nclass SoundObject {\r\n\tconstructor() {\r\n\t\tthis.sounds = new Array();\r\n\t\tthis.loadingQueue = false;\r\n\t\tthis.queueCallback = 0;\r\n\t\tthis.loadedSounds = 0;\r\n\t\tthis.loadingSounds = 0;\r\n\t\tthis.loadedCallback = 0;\r\n\t\tthis.queue = new Array();\r\n\t\tthis.queueLength = 0;\r\n\t\tthis.statusCallback = null;\r\n\t\tthis.directory = \"./sounds/\";\r\n\t\tthis.extension = \".ogg\";\r\n\t\tthis.oneShots = new Array();\r\n\t\tthis.debug = false;\r\n\r\n\r\n\t\tthis.oneShotSound = null;\r\n\t}\r\n\tsetStatusCallback(callback) {\r\n\t\tthis.statusCallback = callback;\r\n\t}\r\n\tfindSound(file) {\r\n\t\tfor (let i = 0; i < this.sounds.length; i++) {\r\n\t\t\tif (this.sounds[i].fileName == file && this.sounds[i].loaded) {\r\n\t\t\t\treturn this.sounds[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\tfindSoundIndex(file) {\r\n\t\tfor (const i in this.sounds) {\r\n\t\t\tif (this.sounds[i].fileName == file) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t}\r\n\r\n\r\n\tresetQueuedInstance() {\r\n\t\tfor (let i = 0; i < this.sounds.length; i++) {\r\n\t\t\tif (typeof this.sounds[i] != \"undefined\") {\r\n\t\t\t\tif (this.sounds[i].tag == 1) {\r\n\t\t\t\t\tthis.sounds[i].sound.destroy();\r\n\t\t\t\t\tthis.sounds.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.loadingQueue = false;\r\n\t\tthis.queueCallback = 0;\r\n\t\tthis.loadedSounds = 0;\r\n\t\tthis.loadingSounds = 0;\r\n\t\tthis.loadedCallback = 0;\r\n\t\tthis.queue = new Array();\r\n\t\tthis.queueLength = 0;\r\n\t\tthis.statusCallback = null;\r\n\t}\r\n\r\n\r\n\r\n\tcreate(file, stream = false) {\r\n\t\tfile = this.directory + file + this.extension;\r\n\t\tlet found = -1;\r\n\t\tfound = this.findSound(file);\r\n\t\tlet returnObject = null;\r\n\t\tif (found == -1 || found.sound.data == null) {\r\n\t\t\treturnObject = new SoundObjectItem(file, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\tthis.sounds.push(returnObject);\r\n\t\t} else {\r\n\t\t\treturnObject = new SoundObjectItem(found.sound.data, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\treturnObject.fileName = found.fileName;\r\n\t\t}\r\n\t\treturnObject.fileName = file; //otherwise html element fileNames get fucked up.\r\n\t\treturn returnObject;\r\n\t}\r\n\tasync loadQueueSync() {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tso.setQueueCallback(() => {\r\n\t\t\t\tresolve(true);\r\n\t\t\t});\r\n\t\t\tso.loadQueue();\r\n\t\t});\r\n\t}\r\n\tasync createSync(file, stream = false) {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tfile = this.directory + file + this.extension;\r\n\t\t\tlet found = -1;\r\n\t\t\tfound = this.findSound(file);\r\n\t\t\tlet returnObject = null;\r\n\t\t\tif (found == -1 || found.sound.data == null) {\r\n\t\t\t\treturnObject = new SoundObjectItem(file, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\t\tthis.sounds.push(returnObject);\r\n\t\t\t\tif (stream) resolve(returnObject);\r\n\t\t\t} else {\r\n\t\t\t\treturnObject = new SoundObjectItem(found.sound.data, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\t\tresolve(returnObject);\r\n\t\t\t}\r\n\t\t\treturnObject.fileName = file; //otherwise html element fileNames get fucked up.\r\n\t\t\tif (stream) resolve(returnObject);\r\n\t\t\tif (!stream) {\r\n\t\t\t\treturnObject.sound.once('loaded', () => {\r\n\t\t\t\t\tresolve(returnObject);\r\n\t\t\t\t\tthis.doneLoading();\r\n\t\t\t\t});// End\r\n\t\t\t}//stream\r\n\t\t});// Promise\r\n\t}\r\n\tasync playSync(file) {\r\n\t\tlet snd = await so.createSync(file);\r\n\t\tawait snd.playSync();\r\n\t\tsnd.destroy();\r\n\t}\r\n\r\n\tenqueue(file, stream = false) {\r\n\t\tfile = this.directory + file + this.extension;\r\n\t\tthis.queue.push({ file, stream });\r\n\t\tthis.queueLength = this.queue.length;\r\n\t}\r\n\r\n\tloadQueue() {\r\n\r\n\t\tthis.handleQueue();\r\n\t\tthis.loadingQueue = true;\r\n\r\n\t}\r\n\tsetQueueCallback(callback) {\r\n\t\tthis.queueCallback = callback;\r\n\t}\r\n\tresetQueue() {\r\n\t\tthis.queue = [];\r\n\t\tthis.loadingQueue = false;\r\n\t}\r\n\thandleQueue() {\r\n\t\tif (this.queue.length > 0) {\r\n\t\t\tif (typeof this.statusCallback != \"undefined\" && this.statusCallback != null) {\r\n\t\t\t\tthis.statusCallback(1 - this.queue.length / this.queueLength);\r\n\t\t\t}\r\n\t\t\tif (this.findSound(this.queue[0].file) != -1) {\r\n\t\t\t\tthis.queue.splice(0, 1);\r\n\t\t\t\tthis.handleQueue();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet file = this.queue[0].file;\r\n\t\t\tlet stream = this.queue[0].stream;\r\n\t\t\tthis.queue.splice(0, 1);\r\n\t\t\tthis.sounds.push(new SoundObjectItem(file, () => { this.handleQueue(); }, 1, stream));\r\n\r\n\t\t} else {\r\n\t\t\tthis.loadingQueue = false;\r\n\t\t\tif (typeof this.queueCallback != \"undefined\" && this.queueCallback != 0) {\r\n\t\t\t\tthis.queueCallback();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\tsetCallback(callback) {\r\n\t\tthis.loadedCallback = callback;\r\n\t}\r\n\tdoneLoading() {\r\n\t\tlet result = this.isLoading();\r\n\r\n\t\tif (result == 1) {\r\n\r\n\t\t\tif (typeof this.loadedCallback != \"undefined\" && this.loadedCallback != 0 && this.loadedCallback != null) {\r\n\t\t\t\tthis.loadedCallback();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tisLoading() {\r\n\t\tlet loading = 0;\r\n\t\tthis.loadedSounds = 0;\r\n\t\tthis.loadingSounds = 0;\r\n\t\tlet stillLoading = new Array();\r\n\t\tfor (let i = 0; i < this.sounds.length; i++) {\r\n\t\t\tif (typeof this.sounds[i] != \"undefined\") {\r\n\t\t\t\tif (this.sounds[i].loaded == false) {\r\n\t\t\t\t\tthis.loadingSounds++;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.loadedSounds++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.loadedSounds / this.sounds.length;\r\n\t}\r\n\r\n\tplayOnce(file) {\r\n\t\tthis.oneShotSound = this.create(file).sound;\r\n\t\tthis.oneShotSound.stop();\r\n\t\tthis.oneShotSound.play();\r\n\t\tthis.oneShotSound.on(\"ended\", () => {\r\n\t\t\tif (this.oneShotSound.playing == false) this.oneShotSound.destroy();\r\n\t\t});\r\n\r\n\t}\r\n\tdestroy(file, callback = 0) {\r\n\t\tlet noMore = false;\r\n\t\tconst filename = this.directory + file + this.extension;\r\n\t\twhile (!noMore) {\r\n\t\t\tconst found = this.findSoundIndex(filename);\r\n\t\t\tif (found == -1) {\r\n\t\t\t\tnoMore = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.sounds[found].sound.unload();\r\n\t\t\t\tthis.sounds.splice(found, 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (callback != 0) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t}\r\n\r\n\tkill(callback = 0) {\r\n\t\twhile (this.sounds.length > 0) {\r\n\t\t\tthis.sounds.splice(0, 1);\r\n\t\t}\r\n\r\n\t\tsono.destroyAll();\r\n\t\tif (callback != 0) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t}\r\n\r\n}\r\nexport let so = new SoundObject();","import \"babel-polyfill\";\r\n'use strict';\r\nimport $ from 'jquery';\r\nimport {KeyEvent} from './keycodes';\r\nimport {so} from './soundObject';\r\nimport {speech} from './tts';\r\nimport copy from 'copy-to-clipboard';\r\nif (runningText == undefined) {\r\n\tvar runningText = 0;\r\n}\r\nclass ScrollingText {\r\n\tconstructor(text, delimiter = '\\n', callback = 0) {\r\n\t\tthis.callback = callback;\r\n\r\n\t\tthis.text = text;\r\n\t\tthis.delimiter = delimiter;\r\n\t\tthis.splitText = this.text.split(delimiter);\r\n\t\tthis.currentLine = 0;\r\n\t\tthis.sndOpen = so.create('ui/textOpen');\r\n\t\tthis.sndContinue = so.create('ui/textScroll');\r\n\t\tthis.sndClose = so.create('ui/textClose');\r\n\t\tconst id = document.getElementById('touchArea');\r\n\t\t// This.hammer = new Hammer(id);\r\n\t\tthis.init();\r\n\t\tif (this.callback == 0) {\r\n\t\t\treturn this.prom = new Promise(resolve => {\r\n\t\t\t\t\tthis.res = resolve;\r\n\t\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tinit() {\r\n\t\tconst that = this;\r\n\t\trunningText = this;\r\n\t\tdocument.addEventListener('keydown', this.handleKeys);\r\n\t\t// This.hammer.on(\"swipeleft swiperight\", function() { that.handleTap(0); });\r\n\t\t// this.hammer.on(\"tap\", function() { that.handleTap(1); });\r\n\t\tthis.sndOpen.play();\r\n\t\tthis.currentLine = 0;\r\n\t\tthis.readCurrentLine();\r\n\t}\r\n\r\n\thandleKeys(event) {\r\n\t\tswitch (event.which) {\r\n\t\t\tcase KeyEvent.DOM_VK_UP:\r\n\t\t\tcase KeyEvent.DOM_VK_DOWN:\r\n\t\t\tcase KeyEvent.DOM_VK_LEFT:\r\n\t\t\tcase KeyEvent.DOM_VK_RIGHT:\r\n\t\t\t\trunningText.readCurrentLine();\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase KeyEvent.DOM_VK_C:\r\n\t\t\t\trunningText.copyCurrentLine();\r\n\t\t\t\tbreak;\r\n\t\t\tcase KeyEvent.DOM_VK_RETURN:\r\n\t\t\t\trunningText.advance();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\thandleTap(action) {\r\n\t\tif (action == 0) {\r\n\t\t\tthis.readCurrentLine();\r\n\t\t}\r\n\r\n\t\tif (action == 1) {\r\n\t\t\tthis.advance();\r\n\t\t}\r\n\t}\r\n\r\n\treadCurrentLine() {\r\n\t\tif (this.splitText[this.currentLine][0] == '!') {\r\n\t\t\tconst str = this.splitText[this.currentLine].substr(1);\r\n\t\t\tconst snd = so.create(str, true);\r\n\t\t\tsnd.play();\r\n\t\t\tsnd.sound.once('end', () => {\r\n\t\t\t\t\tthis.advance();\r\n\t\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tspeech.speak(this.splitText[this.currentLine]);\r\n\t\t}\r\n\t}\r\ncopyCurrentLine() {\r\n\t\t\tcopy(this.splitText[this.currentLine]);\t\r\n\t\t\tthis.advance();\r\n}\r\n\r\n\tadvance() {\r\n\t\tif (this.currentLine < this.splitText.length - 1) {\r\n\t\t\tthis.currentLine++;\r\n\t\t\tthis.sndContinue.play();\r\n\t\t\tthis.readCurrentLine();\r\n\t\t} else {\r\n\t\t\tthis.sndClose.play();\r\n\t\t\tthis.sndClose.unload();\r\n\t\t\tthis.sndOpen.unload();\r\n\t\t\tthis.sndContinue.unload();\r\n\t\t\tdocument.removeEventListener('keydown', this.handleKeys);\r\n\t\t\t//\t\t\tThis.hammer.unload();\r\n\t\t\tif (this.callback != 0) {\r\n\t\t\t\tthis.callback();\r\n\t\t\t} else {\r\n\t\t\t\tthis.res();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nexport {ScrollingText, speech};\r\n","'use strict';\r\nimport { lang } from './main';\r\nimport { utils } from './utilities';\r\nimport { speech } from './tts';\r\nimport { ScrollingText } from './scrollingText';\r\n\r\nclass Strings {\r\n\tconstructor() {\r\n\t\tthis.strings = {};\r\n\t\tthis.strings[1] = {\r\n\t\t\t// New English\r\n\t\t\tselectVoice: \"%1 voices available, use the up and down arrows to select a voice, enter when you're done.\",\r\n\t\t\tmSelectVoice: \"text to speech voice\",\r\n\t\t\tmLang: 'Change language',\r\n\t\t\tnewUpdate: 'There is a new version available! You have version %1, version %2 is available.',\r\n\t\t\tmSapi: 'Use text to speech for the game',\r\n\t\t\tmReader: 'Use your screen reader for the game',\r\n\t\t\tupArrowMove: \"Press the up arrow to start. Change your speed by using the numbers 1 through 5. Letter i check your inventory, and other special keys to use bonus items.\",\r\n\t\t\tnewRate: 'This is a text to speech rate test. Please press enter when done',\r\n\t\t\trating: 'Press right and left arrow keys to change the rate. Press enter when done',\r\n\t\t\tmRate: 'Change speech rate',\r\n\r\n\t\t\tK: 'king',\r\n\t\t\tQ: 'queen',\r\n\t\t\tA: 'ace',\r\n\t\t\tJ: 'jack',\r\n\t\t\tcspades: 'spades',\r\n\t\t\tcdiamonds: 'diamonds',\r\n\t\t\tcclubs: 'clubs',\r\n\t\t\tchearts: 'hearts',\r\n\t\t\tdq: 'This is a game of risk. You will risk losing %1 beatcoins. Continue?',\r\n\t\t\tlang: 'English',\r\n\t\t\tlangs: 'Select your language',\r\n\t\t\tmainmenu: 'main menu: arrow keys to select options, page up and page down raise and lower the music volume. You can also use the first letter of an option to move to it',\r\n\t\t\tmSelect: 'Please select',\r\n\t\t\tmBack: 'go back',\r\n\t\t\tmStart: 'Start Game',\r\n\t\t\tyes: 'Yes',\r\n\t\t\tno: 'no',\r\n\t\t\tok: 'ok',\r\n\t\t};\r\n\t\tthis.strings[2] = {\r\n\t\t\t// New Spanish\r\n\r\n\t\t};\r\n\t}\r\n\r\n\tget(what, rep = []) {\r\n\t\tlet str;\r\n\t\tif (typeof this.strings[lang][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[lang][what];\r\n\t\t} else if (typeof this.strings[1][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[1][what];\r\n\t\t} else {\r\n\t\t\treturn what;\r\n\t\t}\r\n\t\trep.forEach((v, i) => {\r\n\t\t\tconst i1 = Number(i) + 1;\r\n\t\t\tstr = str.replace('%' + i1, v);\r\n\t\t});\r\n\t\treturn str;\r\n\t}\r\n\r\n\tspeak(what, rep = []) {\r\n\t\tlet str;\r\n\t\tif (typeof this.strings[lang][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[lang][what];\r\n\t\t} else if (typeof this.strings[1][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[1][what];\r\n\t\t} else {\r\n\t\t\tspeech.speak(what);\r\n\t\t}\r\n\t\trep.forEach((v, i) => {\r\n\t\t\tconst i1 = Number(i) + 1;\r\n\t\t\tstr = str.replace('%' + i1, v);\r\n\t\t});\r\n\t\tspeech.speak(str);\r\n\t}\r\n\r\n\tasync check(lng) {\r\n\t\tconst len = utils.objSize(this.strings) - 2;\r\n\t\tfor (const i in this.strings[1]) {\r\n\t\t\tif (!this.strings[lng].hasOwnProperty(i)) {\r\n\t\t\t\tawait new ScrollingText(i + ': ' + this.strings[1][i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nexport var strings = new Strings();\r\n","'use strict';\r\nimport { so } from './soundObject';\r\n\r\nimport { KeyboardInput } from './input';\r\nimport { KeyEvent } from './keycodes';\r\nimport { speech } from './tts';\r\nclass LanguageSelector {\r\n\tconstructor(element, callback) {\r\n\t\tthis.langs = [];\r\n\t\tthis.input = new KeyboardInput();\r\n\t\tthis.input.init();\r\n\t\tthis.langs.push(\"select a language. Selecciona un idioma.\");\r\n\t\tthis.langs.push(\"I want to play in English\");\r\n\t\tthis.langs.push(\"Quiero jugar en español.\");\r\n\t\tthis.id = document.getElementById(element);\r\n\t\tthis.callback = callback;\r\n\t\tthis.container = document.createElement('div');\r\n\t\tthis.buttons = [];\r\n\t\tthis.buttons[0] = document.createElement('div');\r\n\t\tthis.buttons[0].innerHTML = this.langs[0];\r\n\t\tthis.container.appendChild(this.buttons[0]);\r\n\t\tfor (let i = 1; i < this.langs.length; i++) {\r\n\t\t\tthis.buttons[i] = document.createElement('input');\r\n\t\t\tthis.buttons[i].type = 'button';\r\n\t\t\tthis.buttons[i].value = this.langs[i];\r\n\t\t\tthis.buttons[i].addEventListener('click', () => {\r\n\t\t\t\tthis.sound.stop()\r\n\t\t\t\tthis.callback(i);\r\n\t\t\t\tthis.container.innerHTML = '';\r\n\t\t\t\tthis.input.removeAllListeners();\r\n\t\t\t\tdocument.getElementById(\"app\").focus();\r\n\t\t\t});\r\n\t\t\tthis.buttons[i].addEventListener('focus', () => {\r\n\t\t\t\tthis.sound.stop();\r\n\t\t\t\tspeech.setLanguage(i);\r\n\t\t\t\tspeech.speak(this.langs[i]);\r\n\t\t\t});\r\n\t\t\tthis.container.appendChild(this.buttons[i]);\r\n\t\t\tthis.input.once(\"chr\" + i, () => {\r\n\t\t\t\tthis.sound.stop()\r\n\t\t\t\tthis.callback(i);\r\n\t\t\t\tthis.container.innerHTML = '';\r\n\t\t\t\tthis.input.removeAllListeners();\r\n\t\t\t\tdocument.getElementById(\"app\").focus();\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.id.appendChild(this.container);\r\n\t\tthis.sound = so.create(\"ui/langSelect\");\r\n\t\tthis.sound.play();\r\n\r\n\t}\r\n}\r\nmodule.exports.LanguageSelector = LanguageSelector;\r\n","'use strict';\r\nimport sono from 'sono';\r\nimport { so } from './soundObject';\r\nimport panner from 'sono/effects/panner';\r\npanner.defaults = {\r\n\tpanningModel: 'HRTF',\r\n\tmaxDistance: 50,\r\n};\r\n/** Simple wrapper for agk-soundobject to quickly create 3D sound sources.\r\n* @constructor\r\n\t* @param {string} file - the path to the file without base directory and extension.\r\n\t* @param {number} x - Initial X coordinate of the sound\r\n\t* @param {number} y - Initial Y coordinate of the sound\r\n\t* @param {number} z - Initial Z coordinate of the sound\r\n\t* @param {boolean} loop - True if the sound should loop\r\n\t* @return {object} A Sound Source object\r\n*/\r\nexport class SoundSource {\r\n\tconstructor(file, x = 0, y = 0, z = 0) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\t\tthis.sound = son.create(file);\r\n\t\tthis.pan = this.sound.effects.add(panner());\r\n\t\tthis.pos(this.x, this.y, this.z);\r\n\t\tthis.rate = 1;\r\n\t\tthis.speed = 0;\r\n\t\tthis.minRate = 0.8;\r\n\t\tthis.maxRate = 1.2;\r\n\t\tthis.toDestroy = false;\r\n\t\tthis.rateShiftSpeed = 0.015;\r\n\t\tthis.sound.currentPosition = 0;\r\n\t}\r\n\tset loop(v) {\r\n\t\tthis.sound.loop = v;\r\n\t}\r\n\t/** Plays the sound source */\r\n\tplay() {\r\n\t\t// This.sound.seek(0);\r\n\t\tthis.sound.play();\r\n\t}\r\n\r\n\t/** Positions the sound source in 3D space.\r\n\t* @param {number} x - The new X coordinate of the sound\r\n\t* @param {number} y - The new Y coordinate of the sound\r\n\t* @param {number} z - The new Z coordinate of the sound\r\n*/\r\n\tpos(x, y, z) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\t\tthis.pan.setPosition(x, y, z);\r\n\t}\r\n\r\n\t/** Empty update method */\r\n\tupdate() {\r\n\t}\r\n}","import { SoundSource } from './soundSource.js';\r\nimport { so } from './soundObject.js';\r\n\r\nclass SoundHandler {\r\n\tconstructor(directional = false) {\r\n\t\tthis.staticSounds = [];\r\n\t\tthis.dynamicSounds = [];\r\n\t\tthis.currentDynamicSound = 0;\r\n\t\tthis.maxDynamicSounds = 512;\r\n\t\tthis.currentStaticSound = 0;\r\n\t\tthis.maxStaticSounds = 512;\r\n\t\tthis.reuseSounds = true;\r\n\t\tthis.x = 0;\r\n\t\tthis.y = 0;\r\n\t\tthis.z = 0;\r\n\t\tthis.directional = directional;\r\n\t}\r\n\r\n\tplayStatic(file, loop = 1, slot = -1, stream = false) {\r\n\t\tif (slot = -1) {\r\n\t\t\tslot = this.findFreeStaticSlot();\r\n\t\t}\r\n\t\tthis.staticSounds[slot] = new SoundItem(file, this.directional, stream);\r\n\t\tif (loop == 1) {\r\n\t\t\tthis.staticSounds[slot].sound.loop = true;\r\n\t\t}\r\n\t\tthis.staticSounds[slot].sound.play();\r\n\t\treturn slot;\r\n\t}\r\n\r\n\tfindFreeStaticSlot() {\r\n\t\tfor (let i = 0; i < this.maxStaticSounds; i++) {\r\n\t\t\tif (this.staticSounds[i] == -1 || typeof this.staticSounds[i] === 'undefined') {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.currentStaticSound < this.maxStaticSounds) {\r\n\t\t\tthis.currentStaticSound++;\r\n\t\t\treturn this.currentStaticSound;\r\n\t\t}\r\n\t\tthis.currentStaticSound = 0;\r\n\t\treturn this.currentStaticSound;\r\n\t}\r\n\r\n\tfindFreeDynamicSlot() {\r\n\t\tfor (let i = 0; i < this.maxDynamicSounds; i++) {\r\n\t\t\tif (this.dynamicSounds[i] == -1 || typeof this.dynamicSounds[i] === 'undefined') {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.currentDynamicSound < this.maxDynamicSounds) {\r\n\t\t\tthis.currentDynamicSound++;\r\n\t\t\treturn this.currentDynamicSound;\r\n\t\t}\r\n\t\tthis.currentDynamicSound = 0;\r\n\t\treturn this.currentDynamicSound;\r\n\t}\r\n\r\n\tfindDynamicSound(file) {\r\n\t\tfor (let i = 0; i < this.dynamicSounds.length; i++) {\r\n\t\t\tif (this.dynamicSounds[i].file == file) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tplay(file) {\r\n\t\tlet slot = 0;\r\n\r\n\t\tlet reuse = 0;\r\n\t\tif (this.reuseSounds) {\r\n\t\t\tslot = this.findDynamicSound(file);\r\n\t\t\treuse = true;\r\n\t\t}\r\n\t\tif (slot == -1 || this.reuseSounds == false) {\r\n\t\t\tslot = this.findFreeDynamicSlot();\r\n\t\t\treuse = false;\r\n\t\t}\r\n\t\tif (typeof this.dynamicSounds[slot] === 'undefined') {\r\n\t\t\tif (reuse == false) {\r\n\t\t\t\tthis.dynamicSounds[slot] = new SoundItem(file, this.directional);\r\n\t\t\t}\r\n\t\t} else if (reuse == false) {\r\n\t\t\tthis.dynamicSounds[slot].sound.destroy();\r\n\t\t\tthis.dynamicSounds[slot] = new SoundItem(file, directional);\r\n\t\t}\r\n\t\tthis.dynamicSounds[slot].sound.play();\r\n\t}\r\n\r\n\tupdate(position) {\r\n\t\tif (this.directional == true) {\r\n\t\t\tfor (let i = 0; i < this.dynamicSounds.length; i++) {\r\n\t\t\t\tthis.dynamicSounds[i].sound.pos(position.x, position.y, position.z);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tfor (var i = 0; i < this.dynamicSounds.length; i++) {\r\n\t\t\tthis.dynamicSounds[i].destroy();\r\n\t\t\tthis.dynamicSounds.splice(i, 1);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this.staticSounds.length; i++) {\r\n\t\t\tthis.staticSounds[i].destroy();\r\n\t\t\tthis.staticSounds.splice(i, 1);\r\n\t\t}\r\n\t}\r\n}\r\nclass SoundItem {\r\n\tconstructor(file, threeD = false, stream = false) {\r\n\t\tthis.file = file;\r\n\t\tthis.threeD = threeD;\r\n\t\tif (this.threeD == true) {\r\n\t\t\tthis.sound = new SoundSource(file, 0, 0, 0);\r\n\t\t} else {\r\n\t\t\tthis.sound = so.create(file, stream);\r\n\t\t}\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.sound.destroy();\r\n\t}\r\n}\r\n\r\nexport { SoundHandler };\r\n","function Timer(callbacks, step) {\r\n\tlet last = 0;\r\n\tlet active = false;\r\n\tlet acc = 0;\r\n\tlet tick = 0;\r\n\tlet inc = step || 1 / 120;\r\n\tlet frameId;\r\n\r\n\tfunction onFrame(time) {\r\n\t\tif (last !== null) {\r\n\t\t\tacc += (time - last) / 1000;\r\n\t\t\twhile (acc > inc) {\r\n\t\t\t\tcallbacks.update(inc, tick);\r\n\t\t\t\ttick += 1;\r\n\t\t\t\tacc -= inc;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlast = time;\r\n\t\tcallbacks.render();\r\n\t\tif (active) {\r\n\t\t\tframeId = requestAnimationFrame(onFrame);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction start() {\r\n\t\tlast = null;\r\n\t\tactive = true;\r\n\t\tframeId = requestAnimationFrame(onFrame);\r\n\t}\r\n\r\n\tfunction stop() {\r\n\t\tactive = false;\r\n\t\tcancelAnimationFrame(frameId);\r\n\t}\r\n\tfunction change(value) {\r\n\t\tinc = value || 1 / 60;\r\n\t\tacc = inc;\r\n\t\ttick = 0;\r\n\t\tstop();\r\n\t\tstart();\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\t\tstop,\r\n\t\t\tchange\r\n\t};\r\n}\r\n\r\nmodule.exports = Timer;\r\n","const EventEmitter = require('events')\r\nexport class GameObject extends EventEmitter {\r\n\r\n    constructor(world, sound, x, y, z, width, height, depth) {\r\n        super()\r\n        this.world = world\r\n        this.alive = true\r\n        this.x = x\r\n        this.y = y\r\n        this.z = z\r\n        if (sound != \"\") {\r\n            this.sound = document.createElement(\"audio\")\r\n            this.sound.src = \"./sounds/\" + sound + \".ogg\"\r\n            this.mediaSource = this.world.context.createMediaElementSource(this.sound)\r\n            this.source = this.world.scene.createSource();\r\n            this.source.sourceWidth = width;\r\n            this.source.sourceHeight = height\r\n            this.source.sourceDepth = depth;\r\n            this.mediaSource.connect(this.source.input);\r\n            this.source.setPosition(this.x, this.y, this.z)\r\n            this.sound.play()\r\n            this.sound.loop = true\r\n\r\n        }\r\n    }\r\n    update() {\r\n\r\n    }\r\n}","import { GameObject } from './gameObject'\r\nimport {utils} from './utilities'\r\n\r\nexport class Tile {\r\n    constructor(world, pos, type, name) {\r\n        this.y = pos;\r\n        this.type = type;\r\n        this.hasSomething = false\r\n        this.world = world;\r\n        this.name = name;\r\n        this.world.player.on(\"step\" + this.y, (() => {\r\n            this.step()\r\n        }))\r\n    }\r\n    step() {\r\n        this.world.game.pool.playStatic(\"steps/\" + this.name + utils.randomInt(1, 3), 0)\r\n        this.world.player.tileType=this.type\r\n    }\r\n    update() {\r\n\r\n    }\r\n    destroy() {\r\n\r\n    }\r\n}","import { GameObject } from './gameObject'\r\nimport { Tile } from './tile'\r\nexport class Street extends Tile {\r\n    constructor(world, pos) {\r\n        super(world, pos, 0, \"street\")\r\n    }\r\n}","import { GameObject } from './gameObject'\r\nimport { Tile } from './tile'\r\nimport { speech } from './tts'\r\nexport class Objective extends Tile {\r\n    constructor(world, pos) {\r\n        super(world, pos, 2, \"objective\")\r\n        this.levelCap = this.world.game.level\r\n        if (this.levelCap > 15) this.levelCap = 15\r\n    }\r\n    scoreDeduct() {\r\n        if (this.y == this.world.player.y) {\r\n            this.world.game.tick.replay()\r\n            this.world.game.score -= (100 * this.world.game.level)\r\n            if (this.world.game.score < 0) this.world.game.score == 0\r\n            this.levelCap = this.world.game.level\r\n            if (this.levelCap > 15) this.levelCap = 15\r\n        }\r\n    }\r\n    destroy() {\r\n        clearTimeout(this.timeout)\r\n    }\r\n    step() {\r\n        super.step()\r\n        let sound = this.world.game.pool.playStatic(\"steps/objective\", 0)\r\n        clearTimeout(this.timeout)\r\n        this.timeout = setTimeout(() => {\r\n            this.scoreDeduct()\r\n        }, 1300 - (this.levelCap * 75))\r\n        this.world.generateTiles()\r\n        this.world.player.slowDown(10)\r\n    }\r\n}","import { GameObject } from './gameObject'\r\nimport { utils } from './utilities'\r\nimport { speech } from './tts'\r\nimport {content} from './main'\r\nexport class Car extends GameObject {\r\n    constructor(world, tile, x, y, width, height, depth, sound = \"car\", speed, side, z = 1, canHorn = false, name) {\r\n        super(world, sound, x, y, z, width, height, depth)\r\n        this.name = name;\r\n        this.speed = speed;\r\n        this.passed = false\r\n        this.side = side;\r\n        this.tile = tile;\r\n        this.canHorn = canHorn\r\n        if (this.canHorn) {\r\n            this.hornSound = document.createElement(\"audio\")\r\n            this.hornSound.src = \"./sounds/horn/\" + this.name + \".ogg\"\r\n            this.hornSource = this.world.context.createMediaElementSource(this.hornSound)\r\n            this.hornResonanceSource = this.world.scene.createSource();\r\n            this.hornSource.connect(this.hornResonanceSource.input);\r\n            this.hornResonanceSource.setPosition(this.x, this.y, this.z)\r\n            this.hornSound.loop = true\r\n        }\r\n    }\r\n    update() {\r\n        if (this.side == 2) this.x += this.speed;\r\n        if (this.side == 1) this.x -= this.speed;\r\n        if (this.x >= this.world.size / 2 || this.x <= (this.world.size / 2) * -1) {\r\n            this.alive = false;\r\n            if (this.canHorn) this.hornSound.pause()\r\n            this.tile.hasSomething = false\r\n        } else {\r\n            this.source.setPosition(this.x, this.y, this.z)\r\n            if (this.passed || (this.canHorn && this.y != this.world.player.y )) {\r\n                this.hornSound.pause()\r\n            }\r\n            if (!this.passed && this.canHorn && this.y == this.world.player.y) {\r\n                this.hornResonanceSource.setPosition(this.x, this.y, this.z)\r\n                this.hornSound.play()\r\n            }\r\n            let distance;\r\n            if (!this.world.player.jump) {\r\n                if (!this.passed) distance = Math.round(utils.distance(this.world.player.x, this.world.player.y, this.x, this.y))\r\n                if (!this.passed) {\r\n                    if (Math.round(this.x) == this.world.player.x && distance > 0) {\r\n                        this.passed = true\r\n                        this.tile.hasSomething=false\r\n                        if (typeof this.tile.timeout!==\"undefined\") {\r\n                        clearTimeout(this.tile.timeout)\r\n                        }\r\n                                this.tile.timeout = setTimeout(() => {\r\n             this.tile.generateCar(utils.randomInt(1, content.numberOfVehicles))\r\n        }, utils.randomInt(0, this.world.game.spawnTime - (this.world.game.level * 100)))\r\n\r\n                        //experimental, nifty, score calculation, but only if the player is on the road, we don't want him collecting points while just standing around.\r\n                        if (distance < 6 && this.world.player.tileType == 1) {\r\n                            const score = Math.round(this.speed * 10000 / (this.world.size / 10) / distance)\r\n                            this.world.game.score += score\r\n                            this.world.game.scoreSound.pitch = utils.getProportion(distance, 1, 5, 0.7, 1.3)\r\n                            this.world.game.scoreSound.replay()\r\n                        }\r\n                    }\r\n                    if (Math.round(this.x) == this.world.player.x && distance == 0) {\r\n                        this.passed = true\r\n                        let healthLoss = Math.round(this.speed * 45);\r\n                        this.world.player.hp -= healthLoss\r\n                        this.world.player.hit()\r\n                        this.world.player.flyTo(this.world.player.nearestStreet, this.side, \"air\")\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import { Car } from './car'\r\n//bus faster\r\nexport class BusFaster extends Car {\r\n    constructor(world, tile, x, y, width, height, depth, side) {\r\n        super(world, tile, x, y, width, height, depth, \"vehicles/busfast\", 0.05, side,2,true,\"busfast\")\r\n        this.name = \"busfast\"\r\n        this.speed = 0.63;\r\n        this.side = side;\r\n        this.tile = tile;\r\n        this.tile.hasSomething = true\r\n    }\r\n}\r\n//bus\r\nexport class Bus extends Car {\r\n    constructor(world, tile, x, y, width=2, height=1, depth=2, side) {\r\n        super(world, tile, x, y, width, height, depth, \"vehicles/bus\", 0.05, side,2,true,\"bus\")\r\n        this.name = \"bus\"\r\n        this.speed = 0.35;\r\n        this.side = side;\r\n        this.tile = tile;\r\n        this.tile.hasSomething = true\r\n    }\r\n}\r\n//biker\r\nexport class Biker extends Car {\r\n    constructor(world, tile, x, y, width, height, depth, side, name = \"biker\") {\r\n        super(world, tile, x, y, width, height, depth, \"vehicles/\" + name, 0.05, side,0.5,true,name)\r\n        this.speed = 0.45\r\n        this.name = name\r\n        this.side = side;\r\n        this.tile = tile;\r\n        this.tile.hasSomething = true\r\n    }\r\n}","import { GameObject } from './gameObject'\r\nimport { debug } from './main'\r\nimport { content } from './main'\r\nimport { utils } from './utilities'\r\nimport { Tile } from './tile'\r\nimport { Bus, BusFaster, Biker } from './vehicles'\r\nimport { speech } from './tts'\r\nexport class Road extends Tile {\r\n    constructor(world, pos) {\r\n        super(world, pos, 1, \"road\")\r\n        this.timeout = setTimeout(() => {\r\n            if (!debug) this.generateCar(utils.randomInt(1, content.numberOfVehicles))\r\n        }, utils.randomInt(0, this.world.game.spawnTime - (this.world.game.level * 100)))\r\n    }\r\n    generateCar(force) {\r\n\r\n        this.timeout = setTimeout(() => {\r\n            if (!debug) this.generateCar(utils.randomInt(1, content.numberOfVehicles))\r\n        }, utils.randomInt(0, this.world.game.spawnTime - (this.world.game.level * 100)))\r\n\r\n        if (this.hasSomething) return;\r\n        let side = utils.randomInt(1, 2)\r\n        let size = this.world.size / 2\r\n        if (side == 1) size = size * 1\r\n        if (side == 2) size = size * -1\r\n        let carType = force\r\n        switch (carType) {\r\n            case 1:\r\n                this.world.dynamicObjects.push(new Bus(this.world, this, size, this.y, 2, 1, 2, side))\r\n                break;\r\n            case 2:\r\n                this.world.dynamicObjects.push(new BusFaster(this.world, this, size, this.y, 2, 1, 2, side))\r\n                break;\r\n            case 3:\r\n                this.world.dynamicObjects.push(new Biker(this.world, this, size, this.y, 1, 1, 1, side))\r\n                break;\r\n\r\n            default: break;\r\n        }\r\n        this.hasSomething = true\r\n    }\r\n    destroy() {\r\n        if (typeof this.timeout !== \"undefined\") clearTimeout(this.timeout)\r\n    }\r\n}","import { GameObject } from './gameObject'\r\nimport { so } from './soundObject'\r\nimport { speech } from './tts';\r\nimport { utils } from './utilities'\r\nimport { debug } from './main'\r\nconst EventEmitter = require('events');\r\nexport class Player extends GameObject {\r\n    constructor(world) {\r\n        super(world, \"\", 0, 0, 1.6, 1, 0.5, 1.6)\r\n        this.playerHitSound = so.create(\"player/hit\")\r\n        this.fallTime = 55\r\n        this.world.scene.setListenerPosition(this.x, this.y, this.z)\r\n        this.unableToMove = false\r\n        this.hp = 100\r\n        this.speedUpSound = so.create(\"ui/speedUp\")\r\n        this.nearestStreet = 0\r\n        this.nearestRoad = 0\r\n        this.nearestObjective = 0\r\n        this.speedDownSound = so.create(\"ui/speedDown\")\r\n        this.speed = 650\r\n        //speed 0 is unused, speeds 1 to 5 are manually attainable, speed 6 is a crawl and speed 7 is super speed.\r\n        this.speeds = [\r\n            0, 650, 530, 420, 350, 235, 890, 120\r\n        ]\r\n        this.speedModifier = 0\r\n        this.currentSpeed = 0\r\n    }\r\n    move() {\r\n        if (this.unableToMove) return;\r\n        this.speedTimeout = setTimeout(() => {\r\n            this.move()\r\n        }, this.speeds[this.currentSpeed] - this.speedModifier)\r\n        if (this.currentSpeed == 0) this.currentSpeed = 1;\r\n        this.xLimit = Math.ceil(this.world.size / 8)\r\n        this.y += 1\r\n\r\n        this.emit(\"step\" + this.y)\r\n        if (this.world.game.input.isDown(KeyEvent.DOM_VK_RIGHT)) {\r\n            this.x++;\r\n            if (this.x > this.world.size / 2 + this.xLimit) this.x = this.world.size / 2 + this.xLimit\r\n        }\r\n        if (this.world.game.input.isDown(KeyEvent.DOM_VK_LEFT)) {\r\n            this.x--;\r\n            if (this.x < this.world.size / 2 - this.xLimit) this.x = this.world.size / 2 - this.xLimit\r\n        }\r\n        this.world.scene.setListenerPosition(this.x, this.y, this.z)\r\n    }\r\n    speedUp(number = 1) {\r\n        if (this.unableToMove) return;\r\n        if (this.currentSpeed == 0) {\r\n            this.speedUpSound.pitch = utils.getProportion(1, 1, 5, 0.8, 1.2)\r\n            this.speedUpSound.replay()\r\n            this.move()\r\n        }\r\n        this.currentSpeed += (number - 1);\r\n        if (this.currentSpeed > 5) this.currentSpeed = 5\r\n        this.speedUpSound.pitch = utils.getProportion(this.currentSpeed, 1, 5, 0.8, 1.2)\r\n        this.speedUpSound.replay()\r\n        speech.speak(this.currentSpeed)\r\n    }\r\n    slowDown(number = 1) {\r\n        if (this.unableToMove) return;\r\n        this.currentSpeed -= number;\r\n        //we don't want the player to be able to stop with the down arrow key, but if some item is forcing the player to stop, we can allow it.\r\n        if (number == 1 && this.currentSpeed == 0) this.currentSpeed = 1;\r\n        if (this.currentSpeed <= 0) {\r\n            this.currentSpeed = 0;\r\n            if (typeof this.speedTimeout !== \"undefined\") clearTimeout(this.speedTimeout)\r\n        }\r\n        if (number == 1) this.speedDownSound.pitch = utils.getProportion(this.currentSpeed, 1, 5, 0.8, 1.2)\r\n        if (number == 1) this.speedDownSound.replay()\r\n        speech.speak(this.currentSpeed)\r\n    }\r\n    hit() {\r\n        this.playerHitSound.play()\r\n        this.world.game.pool.playStatic(\"player/impact/\" + utils.randomInt(1, 4), 0)\r\n\r\n    }\r\n    flyTo(y, side, snd) {\r\n        this.unableToMove = true\r\n        let heart = so.create(\"player/heart\")\r\n        heart.play()\r\n        let sound = so.create(snd)\r\n        sound.loop = true\r\n        sound.volume = 0.3\r\n        let land = so.create(\"player/land\")\r\n        let fall = so.create(\"player/fall\" + utils.randomInt(1, 4))\r\n        let stand = so.create(\"player/stand\")\r\n        sound.pitch = 0.7\r\n        sound.play()\r\n        sound.loop = true\r\n        heart.loop = true\r\n        this.slowDown(10)\r\n        let z = utils.randomInt(11, 21)\r\n        let x;\r\n        let jump = false\r\n        if (side == 1) x = -1;\r\n        if (side == 2) x = 1\r\n        if (side == 3) {\r\n            jump = true;\r\n            this.jump = true;\r\n        }\r\n        this.interval = setInterval(() => {\r\n            if (!jump) this.x += (x * utils.randomInt(3, 5))\r\n            if (this.x < 0 - this.world.size / 2) {\r\n                x = 1\r\n                this.world.game.pool.playStatic(\"player/wall\" + utils.randomInt(1, 3), 0)\r\n            }\r\n            if (this.x > this.world.size / 2) {\r\n                x = -1\r\n                this.world.game.pool.playStatic(\"player/wall\" + utils.randomInt(1, 3), 0)\r\n            }\r\n            sound.pitch += 0.07\r\n            if (this.y > y) {\r\n                this.y -= 0.5;\r\n            }\r\n            if (this.y < y) {\r\n                this.y += 0.5;\r\n            }\r\n            this.z += 1;\r\n            if (this.z >= z) {\r\n                this.y = y;\r\n                clearInterval(this.interval)\r\n                this.interval = setInterval(() => {\r\n                    this.z -= 1;\r\n                    sound.pitch -= 0.07\r\n                    if (this.z <= 0) {\r\n                        clearInterval(this.interval)\r\n                        if (jump) {\r\n                            land.play()\r\n                            this.z = 1.6\r\n                        }\r\n                        if (!jump) {\r\n                            this.x = 0\r\n                            fall.play()\r\n                            this.z = 0\r\n                            setTimeout(() => {\r\n                                stand.replay()\r\n                                stand.sound.on(\"ended\", (() => {\r\n                                    this.z = 1.6\r\n                                    speech.speak(\"stood up\")\r\n                                    this.jump = false\r\n                                    this.unableToMove = false;\r\n                                    heart.stop();\r\n                                    this.slowDown(10)\r\n                                }))\r\n                                this.world.scene.setListenerPosition(this.x, this.y, this.z)\r\n                            }, utils.randomInt(1000, 2000))\r\n                        }\r\n                        this.world.scene.setListenerPosition(this.x, this.y, this.z)\r\n                        sound.stop()\r\n                        heart.stop()\r\n                        this.x = 0\r\n                        this.emit(\"step\" + this.y)\r\n                    }\r\n                    this.world.scene.setListenerPosition(this.x, this.y, this.z)\r\n                }, this.fallTime)\r\n            }\r\n            this.world.scene.setListenerPosition(this.x, this.y, this.z)\r\n        }, this.fallTime * 1.2)\r\n    }\r\n}","import { so } from './soundObject';\r\nimport { Street } from './street'\r\nimport { Objective } from './objective'\r\nimport { Road } from './road'\r\nimport { utils } from './utilities'\r\nimport 'resonance-audio';\r\nconst { ResonanceAudio } = require('resonance-audio')\r\nimport { Player } from './player'\r\nimport { content } from './main'\r\nimport { speech } from './tts';\r\nexport class World {\r\n\tconstructor(game, size = 100) {\r\n\r\n\t\tthis.size = size;\r\n\t\tthis.game = game\r\n\t\tthis.dynamicObjects = []\r\n\t\tthis.tiles = []\r\n\t\tthis.context = new AudioContext()\r\n\t\tthis.convolution=this.context.createConvolver()\r\n\t\tthis.scene = new ResonanceAudio(this.context);\r\n\t\tthis.convolution.connect(this.scene.output)\r\n\t\tthis.scene.output.connect(this.context.destination)\r\n\t\tthis.player = new Player(this)\r\n\t}\r\n\tgenerateTiles() {\r\n\t\tfor (let i = 0; i < this.tiles.length; i++) {\r\n\t\t\tthis.tiles[i].destroy();\r\n\t\t}\r\n\t\tthis.tiles = []\r\n\t\tlet lastStreet = this.player.y;\r\n\t\tlet lastStreetLimit = lastStreet + 4\r\n\t\tthis.player.nearestStreet=lastStreet+1\r\n\t\tfor (let i = lastStreet + 1; i <= lastStreetLimit; i++) {\r\n\t\t\tthis.tiles.push(new Street(this, i))\r\n\t\t\tlastStreet = i;\r\n\t\t}\r\n\t\tlet tiles = Math.round(utils.randomInt(this.game.roadsPerLevel, this.game.roadsPerLevel + (this.game.level/1)))\r\n\t\tlet lastRoad = 0;\r\n\t\tthis.player.nearestRoad=lastStreet+1\r\n\t\tfor (let i = lastStreet + 1; i <= lastStreet+tiles; i++) {\r\n\t\t\tthis.tiles.push(new Road(this, i))\r\n\t\t\tlastRoad = i;\r\n\t\t}\r\n\t\tthis.player.nearestObjective=lastRoad+1\r\n\t\tthis.tiles.push(new Objective(this, lastRoad + 1))\r\n\t}\r\n\tupdate() {\r\n\t\tfor (let i = 0; i < this.dynamicObjects.length; i++) {\r\n\t\t\tif (!this.dynamicObjects[i].alive) {\r\n\t\t\t\tthis.dynamicObjects[i].sound.pause()\r\n\t\t\t\tthis.dynamicObjects.splice(i, 1)\r\n\t\t\t\ti--;\r\n\t\t\t} else {\r\n\t\t\t\tthis.dynamicObjects[i].update()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import { speech } from './tts';\r\nimport { strings } from './strings'\r\nimport { debug, _, content } from './main'\r\nimport { SoundHandler } from './soundHandler'\r\nimport Timer from './timer';\r\nimport $ from 'jquery';\r\nimport { utils } from './utilities';\r\nimport { ScrollingText } from './scrollingText';\r\nimport { KeyboardInput } from './input.js';\r\nimport { KeyEvent } from './keycodes.js';\r\nimport { so } from './soundObject';\r\nimport { World } from './world'\r\nimport { Road } from './road';\r\nclass Game {\r\n\tconstructor() {\r\n\t\tthis.tick = so.create(\"tick\")\r\n\t\tthis.scoreSound = so.create(\"scoreCounter\")\r\n\t\tthis.scoreSound.volume = 0.4\r\n\t\tthis.input = new KeyboardInput();\r\n\t\tthis.pool = new SoundHandler()\r\n\t\tthis.input.init();\r\n\t\tthis.timer = Timer({\r\n\t\t\tupdate: () => this.update(),\r\n\t\t\trender: () => this.render()\r\n\t\t}, 1 / 45);\r\n\t\tthis.score = 0\r\n\t\tthis.level = 1\r\n\t\tthis.spawnTime = 3000 - (this.level * 100)\r\n\t\tthis.roadsPerLevel = 4\r\n\t\tthis.coins = 0\r\n\t}\r\n\r\n\tstart() {\r\n\t\tthis.timer.start();\r\n\t\tthis.world = new World(this, 80)\r\n\t\tif (!debug) this.world.generateTiles()\r\n\t\tspeech.speak(strings.get(\"upArrowMove\"))\r\n\t}\r\n\tupdate(dt) {\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_0)) {\r\n\t\t\tthis.world.player.slowDown(10)\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_D) && debug) {\r\n\t\t\tlet debugRoad = new Road(this.world, 1)\r\n\t\t\tlet number = content.numberOfVehicles\r\n\t\t\tnumber = 2\r\n\t\t\tdebugRoad.generateCar(number)\r\n\t\t\tthis.world.player.y = 1\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_UP)) {\r\n\t\t\tthis.world.player.speedUp()\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_DOWN)) {\r\n\t\t\tthis.world.player.slowDown()\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_C)) {\r\n\t\t\tspeech.speak(this.coins + strings.get(\"coins\"))\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_S)) {\r\n\t\t\tspeech.speak(this.score + strings.get(\"points\"))\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_X)) {\r\n\t\t\tspeech.speak(this.world.player.y+\", \"+this.world.player.x+\", \"+this.world.player.z)\r\n\t\t}\r\n\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_L)) {\r\n\t\t\tspeech.speak(strings.get(\"level\") + this.level)\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_H)) {\r\n\t\t\tspeech.speak(this.world.player.hp + \" \" + strings.get(\"hp\"))\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_1)) {\r\n\t\t\tthis.world.player.slowDown(10)\r\n\t\t\tthis.world.player.speedUp(1)\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_2)) {\r\n\t\t\tthis.world.player.slowDown(10)\r\n\t\t\tthis.world.player.speedUp(2)\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_3)) {\r\n\t\t\tthis.world.player.slowDown(10)\r\n\t\t\tthis.world.player.speedUp(3)\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_4)) {\r\n\t\t\tthis.world.player.slowDown(10)\r\n\t\t\tthis.world.player.speedUp(4)\r\n\t\t}\r\n\t\tif (this.input.isJustPressed(KeyEvent.DOM_VK_5)) {\r\n\t\t\tthis.world.player.slowDown(10)\r\n\t\t\tthis.world.player.speedUp(5)\r\n\t\t}\r\n\t\tthis.world.update()\r\n\t}\r\n\trender() {\r\n\t}\r\n}\r\nexport { Game }","export const debug = false\r\nimport { strings } from './strings'\r\nexport let _\r\nexport let content = {\r\n\tnumberOfVehicles: 3,\r\n}\r\nexport var gameID = \"road\";\r\nimport { speech } from './tts'\r\nimport { LanguageSelector } from './languageSelector'\r\nimport { Game } from './game';\r\nexport var version = \"1.0\";\r\nexport var version2 = \"\";\r\n\r\nexport var lang = 0;\r\nexport var ttsVoice;\r\nexport var ttsRate = 1;\r\nimport $ from 'jquery';\r\n\r\ndocument.addEventListener('DOMContentLoaded', setup);\r\nasync function setup() {\r\n\tdocument.getElementById(\"app\").focus();\r\n\t//the below is an example of a new version notifier. The version2 variable can be used and compared inside a menu or wherever, and would contain the new version of your game based on what your server returns.\r\n\tlet prom = new Promise((resolve, reject) => {\r\n\t\tfetch('http://yourserver.com/versions.php?gameVersionRequest=' + gameID)\r\n\t\t\t.then(event => event.text()) //convert http response into text\r\n\t\t\t.then(data => {\r\n\t\t\t\tversion2 = data;\r\n\t\t\t\tresolve(data); //resolve promise let go.\r\n\t\t\t});\r\n\t});\r\n\tlet langs = new LanguageSelector(\"langSelect\", (result) => {\r\n\t\tlang = result;\r\n\t\tspeech.setLanguage(lang);\r\n\t\t_ = strings.get\r\n\t\tconst game = new Game();\r\n\t\tgame.start();\r\n\t\tconsole.log(\"Success!\");\r\n\t});\r\n}\r\n"]}